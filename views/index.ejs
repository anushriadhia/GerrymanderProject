<!DOCTYPE html>
<html>
  <head>
    <title><%= title %></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
    integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
    integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
    crossorigin=""></script>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="stylesheets/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.4.18/c3.min.js" type="text/javascript"></script>

    <link rel = "stylesheet" href = "//cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
    <script src = "//cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>

    <script src="index.js" type="text/javascript"></script>
  </head>
  <body class="w3-light-grey">

    <!-- Top container -->
    <div class="w3-bar w3-top w3-black w3-large" style="z-index:4">
     <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"><i class="fa fa-bars"></i>  Menu</button>
     <span class="w3-bar-item w3-right">Partisan Gerrymandering Detection</span>
    </div>

    <!-- Sidebar/menu -->
    <nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidebar"><br>
     <div class="w3-container">
       <h5>Map Types</h5>
     </div>
     <div id="div-nav-drawer" class="w3-bar-block">
       <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>
       <a href="#" class="w3-bar-item w3-button w3-padding w3-blue"><i class="fa fa-users fa-fw"></i>  Choropleth</a>

     </div>
    </nav>

    <!-- Overlay effect when opening sidebar on small screens -->
    <div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

    <!-- !PAGE CONTENT! -->
    <div class="w3-main" style="margin-left:300px;margin-top:43px;">

     <!-- Header -->
     <header class="w3-container" style="padding-top:22px">
       <!-- <h5><b><i class="fa fa-dashboard"></i> Choropleth</b></h5> -->
     </header>

     <div class="w3-row-padding w3-margin-bottom">
       <div class="w3-quarter">
         <div class="w3-container w3-red w3-padding-16">
           <div class="w3-left"><i class="fa fa-warning w3-xxxlarge"></i></div>
           <div class="w3-right">
             <h3 id="warnings-text"></h3>
           </div>
           <div class="w3-clear"></div>
           <h4>Gerrymandering Warnings</h4>
         </div>
       </div>
       <div class="w3-quarter">
         <div class="w3-container w3-blue w3-padding-16">
           <div class="w3-left"><i class="fa fa-thumbs-up w3-xxxlarge"></i></div>
           <div class="w3-right">
             <h3 id="safe-metrics-text"></h3>
           </div>
           <div class="w3-clear"></div>
           <h4>Safe Metrics</h4>
         </div>
       </div>
       <div class="w3-quarter">
         <div class="w3-container w3-teal w3-padding-16">
           <div class="w3-left"><i class="fa fa-map-marker w3-xxxlarge"></i></div>
           <div class="w3-right">
             <input id="upload-map-input" type="file"/>
           </div>
           <div class="w3-clear"></div>
           <h4>Upload Map File</h4>
         </div>
       </div>
       <div class="w3-quarter">
         <div class="w3-container w3-orange w3-text-white w3-padding-16">
           <div class="w3-left"><i class="fa fa-user w3-xxxlarge"></i></div>
           <div class="w3-right">
             <input id="upload-demographics-input" type="file"/>
           </div>
           <div class="w3-clear"></div>
           <h4>Upload Demographics File</h4>
         </div>
       </div>
     </div>

     <div class="w3-panel">
       <div class="w3-row-padding" style="margin:0 -16px">
         <table id = "districtTable">
            <thead>
                <tr>
                    <th>District</th>
                    <th>Compactness</th>
                    <th>Reock</th>
                    <th>Polsby-Popper</th>
                    <th>Schwartzberg</th>
                    <th>Charts</th>
                </tr>
            </thead>
            <tbody id="districtTableBody"></tbody>
          </table>
         <div id="div-graphs" class="w3-twothird">
           <h5>Choropleth Map</h5>
           <div id="map"></div>
         </div>
         <div id="div-metrics" class="w3-third">
           <h5>District Information</h5>
           <div id = "pieChart"></div>
           <div id = "barChart"></div>
           <div id = "timeChart"></div>
           <!-- <table id="metrics-table" class="w3-table w3-striped w3-white"></table> -->
         </div>
       </div>
     </div>
    </div>

    <script>
    $(document).ready(function() {

      var ncrGeoJSONDump =  "<%= geoDump %>";
      var obj = JSON.parse(ncrGeoJSONDump.replace(/&#34;/g, '"'));

      var districtTableBodyData = "";

      for (var i = 0; i < Object.keys(obj.features).length; i++) {
        districtTableBodyData += "<tr><th>" + obj.features[i].properties.DISTRICT + "</th><th>" + obj.features[i].properties.Compactness + "</th><th>" + obj.features[i].properties.Reock + "</th><th>" + obj.features[i].properties.PolsbyPopper + "</th><th>" + obj.features[i].properties.Schwartzberg + "</th><th>bar graph</th></tr>";
      }

      $('#districtTableBody').html(districtTableBodyData);
      $('#districtTable').DataTable();


      var colors = ['#dd5555', '#55dd55', '#5555dd'];
      var barChart = c3.generate({
          title: {
              text: 'District 1 Scores'
          },
          bindto: '#barChart',
          data: {
              type: 'bar',
              json: [
                  { 'indicator': 'Reock', 'score': obj.features[0].properties.Reock },
                  { 'indicator': 'Polsby-Popper', 'score': obj.features[0].properties.PolsbyPopper },
                  { 'indicator': 'Schwartzberg', 'score': obj.features[0].properties.Schwartzberg }
              ],
              color: function (color, d) {
                  return colors[d.index];
              },
              keys: {
                  x: 'indicator',
                  value: ['score']
              }
          },
          axis: {
                  x: {
                      type: 'category'
                  },
                  y: {
                      max: 1,
                      min: 0,
                      padding: {top:0, bottom:0}
                  }
          },
          bar: {
              width: {
                  ratio: .9
              }
          }
      });
    });

    </script>
    <!-- <div id = "geoDump"></div> -->
  </body>
</html>
